import{r as a,c as R,R as b}from"./react.js";import{C as L,a as $,i as W,b as N,c as V,f as F}from"./fullcalendar.js";import{S as q,B as v,D as G,R as H,a as B,b as J,M as K,U as Y,c as Q,s as D}from"./antd.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}})();var T={exports:{}},S={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X=a,Z=Symbol.for("react.element"),A=Symbol.for("react.fragment"),ee=Object.prototype.hasOwnProperty,te=X.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ne={key:!0,ref:!0,__self:!0,__source:!0};function P(e,n,i){var r,s={},o=null,l=null;i!==void 0&&(o=""+i),n.key!==void 0&&(o=""+n.key),n.ref!==void 0&&(l=n.ref);for(r in n)ee.call(n,r)&&!ne.hasOwnProperty(r)&&(s[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps,n)s[r]===void 0&&(s[r]=n[r]);return{$$typeof:Z,type:e,key:o,ref:l,props:s,_owner:te.current}}S.Fragment=A;S.jsx=P;S.jsxs=P;T.exports=S;var t=T.exports,z,M=R;z=M.createRoot,M.hydrateRoot;const se=parseInt(String(b.version).split(".")[0]),re=se<18;class _ extends a.Component{constructor(){super(...arguments),this.elRef=a.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const n=[];for(const i of this.state.customRenderingMap.values())n.push(b.createElement(oe,{key:i.id,customRendering:i}));return b.createElement("div",{ref:this.elRef},n)}componentDidMount(){this.isUnmounting=!1;const n=new L;this.handleCustomRendering=n.handle.bind(n),this.calendar=new $(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{R.flushSync(()=>{})});let i;n.subscribe(r=>{const s=Date.now(),o=!i;(re||o||this.isUpdating||this.isUnmounting||s-i<100?k:R.flushSync)(()=>{this.setState({customRenderingMap:r},()=>{i=s,o?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}_.act=k;class oe extends a.PureComponent{render(){const{customRendering:n}=this.props,{generatorMeta:i}=n,r=typeof i=="function"?i(n.renderProps):i;return R.createPortal(r,n.containerEl)}}function k(e){e()}const E="";async function ie(e,n){const{startStr:i,endStr:r}=e,s=new URLSearchParams({startStr:i,endStr:r,teachers:n.join(",")}).toString();return await fetch(`${E}/data?${s}`).then(o=>o.json()).then(o=>{let l=o.data;return l.forEach(u=>{u.title=u.courseName;let f=new Date(Number(u.courseDate));u.start=f.toISOString(),u.end=f.toISOString(),u.allDay=!0}),l}).catch(o=>(console.error("Error:",o),[]))}async function ae(){return await fetch(`${E}/teacher`).then(e=>e.json()).then(e=>e.data).catch(e=>console.error("Error:",e))}const I=a.createContext(void 0),ce=({children:e})=>{const[n,i]=a.useState(window.innerWidth),[r,s]=a.useState(window.innerHeight),o=()=>{i(window.innerWidth),s(window.innerHeight)};return a.useLayoutEffect(()=>(window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)),[]),t.jsx(I.Provider,{value:{width:n,height:r},children:e})},O=()=>a.useContext(I),le=[{label:"month",value:"dayGridMonth"},{label:"week",value:"timeGridWeek"},{label:"day",value:"timeGridDay"}],de=({calendarApi:e,setTeachers:n})=>{const[i,r]=a.useState("dayGridMonth"),[s,o]=a.useState(!0),[l,u]=a.useState([]),f=O();if(!f)return null;const{width:g}=f;a.useEffect(()=>{(async()=>{const p=(await ae()).map(c=>({label:c,value:c}));u(p)})()},[]);const x=h=>{let d=h.toDate();e.gotoDate(d)},y=({target:{value:h}})=>{e.changeView(h),r(h)},j=()=>{o(!s),e.setOption("weekends",!s)},w=h=>{n(h)};return a.useEffect(()=>{e&&e.gotoDate(new Date(2023,2,1))},[e]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",padding:"10px 0px"},children:[t.jsx("span",{style:{marginRight:"10px",minWidth:"120px"},children:"Select lecturers:"}),t.jsx(q,{mode:"multiple",allowClear:!0,style:{width:"100%"},placeholder:"Please select lecturers",onChange:w,options:l})]}),t.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexDirection:g>1200?"row":"column"},children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx(v,{type:"primary",onClick:()=>e==null?void 0:e.today(),children:"Today"}),t.jsx(G,{onChange:x})]}),t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[t.jsx(v,{type:"primary",shape:"circle",icon:t.jsx(H,{}),onClick:()=>e==null?void 0:e.prev()}),t.jsx("h1",{style:{minWidth:"300px",textAlign:"center"},children:e==null?void 0:e.view.title}),t.jsx(v,{type:"primary",shape:"circle",icon:t.jsx(B,{}),onClick:()=>e==null?void 0:e.next()})]}),t.jsxs("div",{style:{display:"flex",gap:"10px",margin:"12px 0px"},children:[t.jsx(v,{type:s?"primary":"default",onClick:j,children:"weekends"}),t.jsx(J.Group,{options:le,optionType:"button",buttonStyle:"solid",onChange:y,value:i})]})]})]})},ue=a.memo(({selectedEvent:e,handleCloseDetails:n})=>{const{title:i,extendedProps:r,start:s}=e||{},{practiceArea:o,courseCode:l,duration:u,software:f,cohort:g,run:x,classroom:y,teacher1:j,teacher2:w,teacher3:h,manager:d,cert:p}=r||{},c=(m,C)=>t.jsxs("p",{children:[t.jsxs("strong",{children:[m,":"]})," ",C]},m);return t.jsxs(K,{width:400,footer:null,title:null,open:e!=null,onOk:n,onCancel:n,children:[t.jsx("h2",{children:i}),c("Practice Area",o),c("Course Code",l),c("Duration (Days)",u),c("Software",f),c("Cohort",g),c("Run #",x),c("Start",s?new Date(s).toLocaleString():""),c("Classroom",y),c("Teacher 1",j),c("Teacher 2",w),c("Teacher 3",h),c("Manager",d),c("Grad Cert (MTech)",p)]})}),he=()=>{const e=a.useRef(null),[n,i]=a.useState(null),[r,s]=a.useState([]),[o,l]=a.useState([]),[u,f]=a.useState(null);a.useEffect(()=>{var p;let d=(p=e.current)==null?void 0:p.getApi();d&&(i(d),s(d.getEvents()))},[]);const g=O();if(!g)return null;const{width:x}=g,y=d=>{f(d.event)},j=()=>{f(null)},w=d=>{const p=d.event.title,c=d.event.extendedProps,m=pe(p),C=x>1320?"18px":x>660?"14px":"10px",U=x>1320?"14px":x>660?"10px":"8px";return t.jsxs("div",{style:{padding:"4px 8px",backgroundColor:m,cursor:"pointer"},children:[t.jsx("i",{style:{fontSize:C,color:"#111",fontWeight:"bold"},children:p}),t.jsxs("div",{style:{fontSize:U,color:"#333",display:"flex",justifyContent:"space-between"},children:[t.jsx("i",{children:c.classroom}),t.jsx("br",{}),t.jsx("i",{children:c.teacher1})]})]})},h=a.useCallback(async(d,p,c)=>{try{let m=await ie(d,o);s(m),p(m)}catch(m){c(m)}},[o]);return t.jsxs("div",{children:[t.jsx(de,{calendarApi:n,setTeachers:l}),t.jsx("div",{children:t.jsx(_,{ref:e,plugins:[W,N,V],headerToolbar:!1,initialView:"dayGridMonth",selectMirror:!0,dayMaxEvents:!0,events:h,eventContent:w,eventClick:y,slotMinTime:"08:00:00",slotMaxTime:"20:00:00",slotDuration:"01:00:00",contentHeight:1500})}),t.jsx(ue,{selectedEvent:u,handleCloseDetails:j}),t.jsx(fe,{events:r})]})};function pe(e){let n=0;for(let r=0;r<e.length;r++)n=e.charCodeAt(r)+((n<<5)-n);let i="#";for(let r=0;r<3;r++){const s=n>>r*8&255;i+=("00"+s.toString(16)).substr(-2)}return i}const fe=({events:e})=>{function n(i){return t.jsxs("li",{children:[t.jsx("b",{children:F(i.start,{year:"numeric",month:"short",day:"numeric"})}),t.jsx("i",{children:i.title})]},i.id)}return t.jsxs("div",{children:[t.jsxs("h2",{children:["All Events (",e.length,")"]}),t.jsx("ul",{children:e.map(n)})]})},me=()=>{const e={accept:".xlsx",action:`${E}/upload`,name:"file",async onChange(n){n.file.status==="done"?D.success(`${n.file.name} file uploaded successfully`):n.file.status==="error"&&D.error(`${n.file.name} file upload failed.`)}};return t.jsx(Y,{...e,children:t.jsx(v,{icon:t.jsx(Q,{}),children:"Click to Upload"})})},xe=()=>{const e=O();return e?t.jsxs("div",{style:{padding:e.width>660?"0px 24px":"0"},children:[t.jsx("h1",{children:"AI-based Scheduling System"}),t.jsx(me,{}),t.jsx(he,{})]}):null};z(document.getElementById("root")).render(t.jsx(a.StrictMode,{children:t.jsx(ce,{children:t.jsx(xe,{})})}));
